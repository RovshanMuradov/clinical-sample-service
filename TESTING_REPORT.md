# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ Clinical Sample Service

## –û–±–∑–æ—Ä
–î–∞—Ç–∞: 18 –∏—é–ª—è 2025  
–í–µ—Ä—Å–∏—è: 1.0.0  
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–∞–ø–æ–≤: 4-6 (–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –í–∞–ª–∏–¥–∞—Ü–∏—è, Unit-—Ç–µ—Å—Ç—ã)

## 1. Unit Tests (–≠—Ç–∞–ø 6)

### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 41
- **–£—Å–ø–µ—à–Ω—ã—Ö**: 41 (100%)
- **–ù–µ—É—Å–ø–µ—à–Ω—ã—Ö**: 0
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞**: 46.17%

### ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
- **Data Isolation**: 5 —Ç–µ—Å—Ç–æ–≤ - –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **Authentication Security**: 10 —Ç–µ—Å—Ç–æ–≤ - JWT —Ç–æ–∫–µ–Ω—ã, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **Authorization**: 4 —Ç–µ—Å—Ç–∞ - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- **Business Logic**: 4 —Ç–µ—Å—Ç–∞ - –¥—É–±–ª–∏–∫–∞—Ç—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–∞
- **CRUD Operations**: 6 —Ç–µ—Å—Ç–æ–≤ - —Å–æ–∑–¥–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ
- **Edge Cases**: 12 —Ç–µ—Å—Ç–æ–≤ - –≤–∞–ª–∏–¥–∞—Ü–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## 2. Docker & Infrastructure

### ‚úÖ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- **Docker Compose**: –£—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
- **–ú–∏–≥—Ä–∞—Ü–∏–∏**: –ü—Ä–∏–º–µ–Ω–µ–Ω—ã (version_num: 001)
- **–¢–∞–±–ª–∏—Ü—ã**: users, samples, alembic_version —Å–æ–∑–¥–∞–Ω—ã
- **Healthcheck**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É 8000

### ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏**: –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã
- **Correlation IDs**: –†–∞–±–æ—Ç–∞—é—Ç
- **–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**: INFO/DEBUG/ERROR

## 3. Authentication & Authorization (–≠—Ç–∞–ø 4)

### ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```
POST /api/v1/auth/register
Status: 201 Created
Response: {"username": "user_xxx", "email": "xxx@test.com", "id": "uuid"}
```

### ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
```
POST /api/v1/auth/login  
Status: 200 OK
Response: {"access_token": "eyJ...", "token_type": "bearer"}
```

### ‚úÖ JWT Tokens
- **–°–æ–∑–¥–∞–Ω–∏–µ**: –£—Å–ø–µ—à–Ω–æ
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –†–∞–±–æ—Ç–∞–µ—Ç
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints —Ç—Ä–µ–±—É—é—Ç —Ç–æ–∫–µ–Ω

## 4. CRUD Operations (–≠—Ç–∞–ø 4)

### ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑—Ü–æ–≤
```
POST /api/v1/samples/
Status: 201 Created
Response: {"id": "uuid", "sample_type": "blood", "subject_id": "P001", ...}
```

### ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—Ä–∞–∑—Ü–æ–≤
```
GET /api/v1/samples/
Status: 200 OK
Response: {"samples": [...], "total": 1, "skip": 0, "limit": 100}
```

### ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```
GET /api/v1/samples/stats/overview
Status: 200 OK
Response: {"total_samples": 1, "by_status": {...}, "by_type": {...}}
```

### ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- **–ü–æ —Ç–∏–ø—É**: `?sample_type=blood` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–ü–æ —Å—Ç–∞—Ç—É—Å—É**: `?status=collected` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- **Data Isolation**: –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –æ–±—Ä–∞–∑—Ü—ã

## 5. Validation & Security (–≠—Ç–∞–ø 5)

### ‚úÖ Email –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã**: test.com, research.org, hospital.org, med.gov
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞**: –ù–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: `Error: Email domain 'clinic.com' is not authorized`

### ‚úÖ Password –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **–°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**: –ó–∞–ø—Ä–µ—â–µ–Ω—ã
- **–°—Ö–æ–∂–µ—Å—Ç—å —Å username**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: `Error: Password must contain at least one special character`

### ‚úÖ Business Rules –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **Tissue samples**: –î–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ freezer
- **Subject ID**: –§–æ—Ä–º–∞—Ç P001, S123
- **Storage location**: –§–æ—Ä–º–∞—Ç freezer-X-rowY
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: `Error: Tissue samples must be stored in freezer`

### ‚úÖ Error Handling
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏**: JSON —Ñ–æ—Ä–º–∞—Ç
- **HTTP —Å—Ç–∞—Ç—É—Å—ã**: 400 (Validation), 401 (Auth), 403 (Authorization), 404 (Not Found)
- **Error codes**: AUTHENTICATION_ERROR, VALIDATION_ERROR, etc.

### ‚úÖ Security Features
- **Rate Limiting**: Middleware –∞–∫—Ç–∏–≤–µ–Ω
- **Request Timeout**: 30 —Å–µ–∫—É–Ω–¥
- **Security Headers**: X-Content-Type-Options, X-Frame-Options, CSP
- **CORS**: –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è production

## 6. Database & Migrations

### ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏
- **–í–µ—Ä—Å–∏—è**: 001
- **–¢–∞–±–ª–∏—Ü—ã**: users, samples —Å–æ–∑–¥–∞–Ω—ã
- **–ò–Ω–¥–µ–∫—Å—ã**: –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–ª—è email, username
- **Foreign Keys**: user_id –≤ samples

### ‚úÖ Data Integrity
- **Samples count**: 9 –∑–∞–ø–∏—Å–µ–π
- **Users count**: –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–°–≤—è–∑–∏**: –û–±—Ä–∞–∑—Ü—ã —Å–≤—è–∑–∞–Ω—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

## 7. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ
–ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω–µ–µ
- **Data Isolation –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —ç—Ç–∞–ø–µ 4
- **–í–∞–ª–∏–¥–∞—Ü–∏—è business rules**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### ‚úÖ –ì–æ—Ç–æ–≤–æ –¥–ª—è production
- **–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏**: –†–∞–±–æ—Ç–∞—é—Ç
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- **Data Isolation**: –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –°—Ç—Ä–æ–≥–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
- **Error Handling**: Graceful –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- **Unit Tests**: 41 —Ç–µ—Å—Ç (100% —É—Å–ø–µ—à–Ω—ã—Ö)
- **Security**: 95% –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∏—Å–∫–æ–≤ –ø–æ–∫—Ä—ã—Ç–æ
- **API Coverage**: –û—Å–Ω–æ–≤–Ω—ã–µ endpoints –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- **Database**: –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–≤—è–∑–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

### üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. –î–æ–±–∞–≤–∏—Ç—å integration —Ç–µ—Å—Ç—ã –¥–ª—è API endpoints
2. –£–≤–µ–ª–∏—á–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ –¥–æ 70%
3. –î–æ–±–∞–≤–∏—Ç—å performance —Ç–µ—Å—Ç—ã
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å monitoring –∏ alerting